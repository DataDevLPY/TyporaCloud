## 一、DDL

### 1. 移动表

![截屏2021-11-08 下午7.37.34](https://raw.githubusercontent.com/DataDevLPY/TyporaPicStore/main/img/%E6%88%AA%E5%B1%8F2021-11-08%20%E4%B8%8B%E5%8D%887.37.34.png?token=AWS37JPGEDSOYVRVNESAANLBTIIYI)

![截屏2021-11-08 下午7.37.49](https://raw.githubusercontent.com/DataDevLPY/TyporaPicStore/main/img/%E6%88%AA%E5%B1%8F2021-11-08%20%E4%B8%8B%E5%8D%887.37.49.png?token=AWS37JIFXS5SDN2T3TD67UTBTIIYM)

### 2. 设置表属性

![截屏2021-11-08 下午7.39.41](https://raw.githubusercontent.com/DataDevLPY/TyporaPicStore/main/img/%E6%88%AA%E5%B1%8F2021-11-08%20%E4%B8%8B%E5%8D%887.39.41.png?token=AWS37JPHLTJ6GFXZK6EJWTTBTIIYQ)



## 二、DML

### 1. 插入数据

![截屏2021-11-08 下午7.47.24](https://raw.githubusercontent.com/DataDevLPY/TyporaPicStore/main/img/%E6%88%AA%E5%B1%8F2021-11-08%20%E4%B8%8B%E5%8D%887.47.24.png?token=AWS37JIJLSJD7H3XHZTB2K3BTIIY2)



### 2. 更新删除数据

<font color='red'>只有MergeTree引擎的数据才能修改</font>

**1）删除分区数据**

![截屏2021-11-08 下午7.52.34](https://raw.githubusercontent.com/DataDevLPY/TyporaPicStore/main/img/%E6%88%AA%E5%B1%8F2021-11-08%20%E4%B8%8B%E5%8D%887.52.34.png?token=AWS37JLFMFLLIS6ZNUPUTB3BTIIY4)

**2）条件删除数据**

![截屏2021-11-08 下午7.54.49](https://raw.githubusercontent.com/DataDevLPY/TyporaPicStore/main/img/%E6%88%AA%E5%B1%8F2021-11-08%20%E4%B8%8B%E5%8D%887.54.49.png?token=AWS37JNKKWHHHLPTBHHZVIDBTIIZY)

**3）条件更新数据**

![截屏2021-11-08 下午7.56.03](https://raw.githubusercontent.com/DataDevLPY/TyporaPicStore/main/img/%E6%88%AA%E5%B1%8F2021-11-08%20%E4%B8%8B%E5%8D%887.56.03.png?token=AWS37JMMCYEI5BEXVVZTO5TBTII2E)



## 三、分区表

<font color='red'>目前只有MergeTree支持分区表</font>

**1. 底层数据存储**

![截屏2021-11-08 下午8.01.08](https://raw.githubusercontent.com/DataDevLPY/TyporaPicStore/main/img/%E6%88%AA%E5%B1%8F2021-11-08%20%E4%B8%8B%E5%8D%888.01.08.png?token=AWS37JMKHWYSU7HXZ4SGH4TBTII2S)

![截屏2021-11-08 下午8.04.29](https://raw.githubusercontent.com/DataDevLPY/TyporaPicStore/main/img/%E6%88%AA%E5%B1%8F2021-11-08%20%E4%B8%8B%E5%8D%888.04.29.png?token=AWS37JK63255DQMG33HPZILBTII2U)

**2. 复制分区**

![截屏2021-11-08 下午8.12.36](https://raw.githubusercontent.com/DataDevLPY/TyporaPicStore/main/img/%E6%88%AA%E5%B1%8F2021-11-08%20%E4%B8%8B%E5%8D%888.12.36.png?token=AWS37JKER7KUT6C4EVQMBSTBTII3C)

**3. 卸载分区**

![截屏2021-11-08 下午8.15.19](https://raw.githubusercontent.com/DataDevLPY/TyporaPicStore/main/img/%E6%88%AA%E5%B1%8F2021-11-08%20%E4%B8%8B%E5%8D%888.15.19.png?token=AWS37JKY4JUH2EDCI7SZTA3BTII3K)

![截屏2021-11-08 下午8.17.05](/Users/peiyang/Library/Application Support/typora-user-images/截屏2021-11-08 下午8.17.05.png)

**4. 装载分区**

![截屏2021-11-08 下午8.18.13](https://raw.githubusercontent.com/DataDevLPY/TyporaPicStore/main/img/%E6%88%AA%E5%B1%8F2021-11-08%20%E4%B8%8B%E5%8D%888.18.13.png?token=AWS37JKC7CP7FYITEYV2W4TBTII4I)



## 四、视图

**1. 普通视图**

![截屏2021-11-08 下午8.21.38](https://raw.githubusercontent.com/DataDevLPY/TyporaPicStore/main/img/%E6%88%AA%E5%B1%8F2021-11-08%20%E4%B8%8B%E5%8D%888.21.38.png?token=AWS37JKENBF6ZV4PIRTFSYDBTII4K)

**2. 物化视图**

插入数据的时候同步聚合，构建查询的立方体，同步明细表的数据

![截屏2021-11-08 下午8.25.09](https://raw.githubusercontent.com/DataDevLPY/TyporaPicStore/main/img/%E6%88%AA%E5%B1%8F2021-11-08%20%E4%B8%8B%E5%8D%888.25.09.png?token=AWS37JJSBXH5WQY4G6HRBWLBTII4Y)

![截屏2021-11-08 下午8.28.12](https://raw.githubusercontent.com/DataDevLPY/TyporaPicStore/main/img/%E6%88%AA%E5%B1%8F2021-11-08%20%E4%B8%8B%E5%8D%888.28.12.png?token=AWS37JIZZHGB3ML3IIZNJRTBTII5Y)

![截屏2021-11-08 下午8.32.43](https://raw.githubusercontent.com/DataDevLPY/TyporaPicStore/main/img/%E6%88%AA%E5%B1%8F2021-11-08%20%E4%B8%8B%E5%8D%888.32.43.png?token=AWS37JIGUDMKECY6QSXI35TBTII52)

```
执行完上述CREATE MATERIALIZED VIEW语句后，通过SHOW TABLES语句查询，会发现有一张名为.inner.[物化视图名]的表，这就是持久化物化视图数据的表，当然我们是不会直接操作它的。
```

![img](https://raw.githubusercontent.com/DataDevLPY/TyporaPicStore/main/img/webp?token=AWS37JNYI3ZEE2FNS7KMIRDBTII6G)

## 五、关联查询

![截屏2021-11-10 上午10.21.00](https://raw.githubusercontent.com/DataDevLPY/TyporaPicStore/main/img/%E6%88%AA%E5%B1%8F2021-11-10%20%E4%B8%8A%E5%8D%8810.21.00.png?token=AWS37JORGSSIVKNK53RQDO3BTII6W)

**-- 连接精度**

![截屏2021-11-10 上午10.03.07](https://raw.githubusercontent.com/DataDevLPY/TyporaPicStore/main/img/%E6%88%AA%E5%B1%8F2021-11-10%20%E4%B8%8A%E5%8D%8810.03.07.png?token=AWS37JPYJEX4QLFIJRMPQBDBTII6Y)

![截屏2021-11-10 上午10.03.38](https://raw.githubusercontent.com/DataDevLPY/TyporaPicStore/main/img/%E6%88%AA%E5%B1%8F2021-11-10%20%E4%B8%8A%E5%8D%8810.03.38.png?token=AWS37JMRBDSH6E7BH2QORV3BTII7C)



![截屏2021-11-10 上午10.24.47](https://raw.githubusercontent.com/DataDevLPY/TyporaPicStore/main/img/%E6%88%AA%E5%B1%8F2021-11-10%20%E4%B8%8A%E5%8D%8810.24.47.png?token=AWS37JJ675FE6MLC2UJ7QITBTII7K)

![截屏2021-11-10 上午10.25.01](/Users/peiyang/Library/Application Support/typora-user-images/截屏2021-11-10 上午10.25.01.png)

![截屏2021-11-10 上午10.25.15](https://raw.githubusercontent.com/DataDevLPY/TyporaPicStore/main/img/%E6%88%AA%E5%B1%8F2021-11-10%20%E4%B8%8A%E5%8D%8810.25.15.png?token=AWS37JIJL33WCF2G3JELQEDBTII7W)

**asof**

![截屏2021-11-10 上午10.26.39](https://raw.githubusercontent.com/DataDevLPY/TyporaPicStore/main/img/%E6%88%AA%E5%B1%8F2021-11-10%20%E4%B8%8A%E5%8D%8810.26.39.png?token=AWS37JJ6E67K476OURLSAJLBTIJAA)

![截屏2021-11-10 上午10.28.08](https://raw.githubusercontent.com/DataDevLPY/TyporaPicStore/main/img/%E6%88%AA%E5%B1%8F2021-11-10%20%E4%B8%8A%E5%8D%8810.28.08.png?token=AWS37JMHOTJLUTF7UJYVVUTBTIJAK)

