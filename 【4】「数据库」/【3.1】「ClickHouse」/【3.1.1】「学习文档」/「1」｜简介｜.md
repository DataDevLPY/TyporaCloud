## 一、数据库比对

```
* mysql
	在数据较少的情况下，查询速度较快，支持事务管理
	单节点单机，存储数据量有限
* hbase
	大数据分布式数据库，可以存储海量数据
	不太支持sql
	经常使用hbase存储标签数据，key-value模式
* hive
	良好的语法和窗口函数，适合做分析报表以及统计
	实时性不高
```

## 二、简介

```
1）OLAP（联机分析）列式数据库管理系统
2）在线分析处理查询
3）名字：click Stream data warehouse
4）用于处理实时数据，关于事件，快速
5）分布式数据库，支持线性扩展，简单方便、高可靠性、容错
6）它在大数据领域没有走Hadoop生态，而是采用Local attached storage,在整个IO就没有Hadoop那一套的局限。
```

## 三、优点和缺点

```
**优点**
1. 灵活的MPP架构，支持线性扩展，简单方便，高可靠性
2. 多服务器分布式处理数据，完备的DBMS系统
3. 底层数据劣势存储，支持压缩，优化数据存储，优化索引数据，优化底层存储
4. 容错跑分快：比Vertica快5倍，比Hive快279倍，比Mysql快800倍，其可处理的数据级别已经达到10亿级别
5. 功能多：支持数据统计分析各种场景，支持类SQL查询，异地复制部署
	海量数据存储，分布式运算，快速闪电的性能，几乎实时的数据分析，友好的SQL语法，出色的函数支持

**缺点**
1. 不支持事务，不支持真正的删除/更新
2. 单节点不支持高并发，官方建议qps为100，可以通过修改配置文件增加连接数，但那是在服务器足够好的情况下
3. 不支持二级索引
4. 不擅长多表join
5. 元数据管理需要人为干预
6. 尽量做1000以上批量的写入，避免逐行insert或小批量的insert，update，delete操作
```

## 四、应用场景

```
1. 绝大多数请求都是用于读访问的，要求实时返回结果
2. 数据需要以大批次（大于1000行）进行更新，而不是单行更新；或者根本没有更新操作
```

![image-20211105151434457](https://raw.githubusercontent.com/DataDevLPY/TyporaPicStore/main/Pictureimage-20211105151434457.png?token=AWS37JJDV5RESUNARRIFKIDBTJFG4)

## 五、核心概念

### 1）数据分片

![image-20211105151719567](https://raw.githubusercontent.com/DataDevLPY/TyporaPicStore/main/Pictureimage-20211105151719567.png?token=AWS37JNZXDXNE3AB6OG2VA3BTJFH6)

### 2）列式数据库更适合OLAP场景的原因[ ](https://clickhouse.com/docs/zh/#lie-shi-shu-ju-ku-geng-gua-he-olapchang-jing-de-yuan-yin)

```
列式数据库更适合于OLAP场景(对于大多数查询而言，处理速度至少提高了100倍)，下面详细解释了原因(通过图片更有利于直观理解)：
```

**行式**

![Row oriented](https://raw.githubusercontent.com/DataDevLPY/TyporaPicStore/main/Picturerow-oriented.gif?token=AWS37JIXUVT5GDSDKS6GFCDBTJGX6)

**列式**

![Column oriented](https://raw.githubusercontent.com/DataDevLPY/TyporaPicStore/main/Picturecolumn-oriented-20211121214611403.gif?token=AWS37JKLGNRDCPBVJ6OA7A3BTJG6C)

### 3) 向量化

![截屏2021-11-07 下午8.49.05](/Users/peiyang/Library/Application Support/typora-user-images/截屏2021-11-07 下午8.49.05.png)

### 4) 副本

```
数据存储副本，在集群模式下实现高可用，简单理解就是相同的数据备份，在CK中通过复制集，我们实现保障了数据可靠性外，也通过多副本的方式，增加了CK查询的并发能力。这里一般有2种方式：
​	（1）基于ZooKeeper的表复制方式
​	（2）基于Cluster的复制方式。
由于我们推荐的数据写入方式本地表写入，禁止分布式表写入，所以我们的复制表只考虑ZooKeeper的表复制方案。
```

### 5) 引擎

```
不同的引擎决定了表数据的存储特点和表数据的操作行为：
​	（1）决定表存储在那里以及以何种方式存储
​	（2）支持哪些查询以及如何支持
​	（3）并发数据访问
​	（4）索引的使用
​	（5）是否可以执行多线程请求
​	（6）数据复制参数
​	（7）并发操作
表引擎决定了数据在文件系统中的存储方式，常用的也是官方推荐的存储引擎MergeTree系列，如果需要数据副本的话可以使用ReplicatedMergeTree系列，相当于MergeTree的副本版本。读取集群数据需要使用分布式表引擎Distribute
```













