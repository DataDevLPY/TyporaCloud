## 垃圾分代回收机制

栈：用于计算的 无用内容立即清除

方法区：类的信息

堆：存储的是对象，无用的对象（垃圾）



java在执行底层操作时在底层开辟操作空间、维护空间、回收内存空间，都是java自己完成的



当程序启动时，针对堆内进行监测，监测堆内存的使用比例，如果使用比例超过70%就会启动GC（Garbage Collector 垃圾回收器）通知系统进行回收----System.gc()





堆内存分为新生代和老生代，新生代分为伊甸园区和幸存区，幸存区分为 fromspace和tospace，创建的新对象，对这个对象进行一次扫描，如果这个对象无用了就通知系统对垃圾回收，如果还在使用就把这个对象移动到幸存区，进行多次扫描如果对象无用了，就通知系统进行垃圾回收，如果还在使用，就把这个对象移动到老生代，进行多次扫描（频率比幸存区的低），如果这个对象是无用对象，就通知系统进行垃圾回收，如果还在使用就留在老生代。如果老生代的对象突然消失，可能会造成我们系统的崩溃。



初代回收：针对新生代的回收（minor collect）

完全回收：针对老生代和新生代的回收（full collect）



如果新创建的对象很大，先把这个对象放到新生代的伊甸园区，放入失败，就会对新生代进行**第一次初代回收**，再次放入新生代，放入失败，在对新生代进行**第二次初代回收**，再次放入新生代，放入失败，此时就会把这个对象放入到老生代，放入失败，进行一次，**完全回收**，把这个对象放入新生代，放入失败，再针对新生代进行**第三次初代回收**，再放入到新生代，放入失败，把这个对象放入到老生代，放入失败，此时针对老生代进行**第二次完全回收**，新对象再次往新生代存储，放入失败，移动到老生代进行存储，放入失败---**报错OutofMemoryError**----内存溢出异常

![截屏2021-05-27 下午8.01.27](/Users/peiyang/Library/Application Support/typora-user-images/截屏2021-05-27 下午8.01.27.png)

